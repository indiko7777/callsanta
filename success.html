<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Successful - CallSanta.us</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Outfit:wght@300;400;600;700&display=swap"
        rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        santa: {
                            red: '#D42426',
                            gold: '#C5A059',
                            green: '#0F5132',
                        }
                    },
                    fontFamily: {
                        'outfit': ['Outfit', 'sans-serif'],
                        'playfair': ['Playfair Display', 'serif'],
                    }
                }
            }
        }
    </script>
    <!-- Facebook Pixel Code -->
    <script>
        !function (f, b, e, v, n, t, s) {
            if (f.fbq) return; n = f.fbq = function () {
                n.callMethod ?
                    n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = []; t = b.createElement(e); t.async = !0;
            t.src = v; s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s)
        }(window, document, 'script',
            'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '3889032858055282');
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
            src="https://www.facebook.com/tr?id=3889032858055282&ev=PageView&noscript=1" /></noscript>
    <!-- End Facebook Pixel Code -->
         <!-- TikTok Pixel Code Start -->
<script>
!function (w, d, t) {
  w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie","holdConsent","revokeConsent","grantConsent"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(
var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var r="https://analytics.tiktok.com/i18n/pixel/events.js",o=n&&n.partner;ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=r,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};n=document.createElement("script")
;n.type="text/javascript",n.async=!0,n.src=r+"?sdkid="+e+"&lib="+t;e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(n,e)};


  ttq.load('D4NQGU3C77UBODKKH8O0');
  ttq.page();
}(window, document, 'ttq');
</script>
<!-- TikTok Pixel Code End -->
    <style>
        body {
            font-family: 'Outfit', sans-serif;
        }

        .hero-title {
            font-family: 'Playfair Display', serif;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fadeInUp {
            animation: fadeInUp 0.8s ease-out forwards;
        }

        .stagger-1 {
            animation-delay: 0.2s;
            opacity: 0;
        }

        .stagger-2 {
            animation-delay: 0.4s;
            opacity: 0;
        }

        .stagger-3 {
            animation-delay: 0.6s;
            opacity: 0;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .float-animation {
            animation: float 3s ease-in-out infinite;
        }

        .glass-card {
            background: rgba(15, 23, 42, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .shimmer {
            background: linear-gradient(90deg,
                    rgba(197, 160, 89, 0.1) 0%,
                    rgba(197, 160, 89, 0.3) 50%,
                    rgba(197, 160, 89, 0.1) 100%);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }

            100% {
                background-position: 200% 0;
            }
        }

        .message-santa {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: white;
            border-radius: 18px 18px 18px 4px;
            padding: 12px 16px;
            margin-bottom: 12px;
            max-width: 80%;
        }

        .message-child {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            color: white;
            border-radius: 18px 18px 4px 18px;
            padding: 12px 16px;
            margin-bottom: 12px;
            margin-left: auto;
            max-width: 80%;
        }
    </style>
</head>

<body class="bg-slate-950 text-white min-h-screen overflow-y-auto">

    <div class="fixed inset-0 z-0">
        <div class="absolute inset-0 bg-gradient-to-b from-slate-950/50 via-slate-950/70 to-slate-950/90 z-10"></div>
        <img src="https://images.unsplash.com/photo-1512389142860-9c449e58a543?w=1920&q=80" alt="Christmas background"
            class="w-full h-full object-cover opacity-40">
    </div>

    <div class="relative z-20 min-h-screen py-8 px-4 sm:px-6 lg:px-8">
        <div class="max-w-4xl mx-auto space-y-8">

            <div class="text-center animate-fadeInUp">
                <div
                    class="inline-flex items-center justify-center w-20 h-20 sm:w-24 sm:h-24 bg-gradient-to-br from-green-400 to-emerald-600 rounded-full shadow-2xl shadow-green-500/50 mb-6 float-animation">
                    <i data-lucide="check" class="w-10 h-10 sm:w-12 sm:h-12 text-white stroke-[3]"></i>
                </div>
                <h1
                    class="hero-title text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-black text-white mb-4 leading-tight">
                    Payment Successful!
                </h1>
                <p class="text-lg sm:text-xl md:text-2xl text-gray-200 font-light">
                    <span id="greeting-message">Thank you for your purchase!</span>
                </p>
            </div>

            <div id="call-success-container" class="hidden animate-fadeInUp stagger-1">
                <div class="glass-card rounded-3xl p-6 sm:p-8 lg:p-10 shadow-2xl space-y-6 sm:space-y-8">

                    <div class="text-center pb-6 border-b border-white/10">
                        <h2
                            class="hero-title text-3xl sm:text-4xl md:text-5xl font-black text-santa-gold mb-3 leading-tight">
                            Santa is Waiting<br class="sm:hidden"> for Your Call!
                        </h2>
                        <p class="text-base sm:text-lg text-gray-300">The magic is just a phone call away</p>
                    </div>

                    <div
                        class="bg-gradient-to-br from-santa-red/20 via-red-900/30 to-santa-red/20 p-6 sm:p-8 lg:p-10 rounded-2xl border-2 border-santa-red shadow-xl shimmer">
                        <p class="text-xs sm:text-sm text-gray-300 uppercase tracking-widest mb-3 text-center">Your
                            Private Access Code</p>
                        <p id="access-code-display"
                            class="text-6xl sm:text-7xl md:text-8xl lg:text-9xl font-mono font-black text-santa-red text-center tracking-wider mb-6">
                            ----
                        </p>
                        <div class="pt-6 border-t border-white/20 text-center">
                            <p class="text-sm sm:text-base text-gray-300 mb-2">Santa's Hotline</p>
                            <p id="hotline-number" class="text-2xl sm:text-3xl md:text-4xl font-bold text-white">+1 438 795 1562</p>
                        </div>
                    </div>

                    <div class="glass-card p-6 sm:p-8 rounded-2xl space-y-4 sm:space-y-5">
                        <h3 class="text-xl sm:text-2xl font-bold text-santa-gold flex items-center gap-3">
                            <i data-lucide="phone-call" class="w-6 h-6 sm:w-7 sm:h-7"></i>
                            How to Connect with Santa
                        </h3>
                        <ol class="space-y-4 sm:space-y-5">
                            <li class="flex items-start gap-3 sm:gap-4">
                                <span
                                    class="flex-shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white text-sm sm:text-base">1</span>
                                <span class="text-base sm:text-lg text-gray-200 pt-1"><span
                                        class="font-semibold text-white">Find a quiet spot</span> with your child and
                                    hand them the phone.</span>
                            </li>
                            <li class="flex items-start gap-3 sm:gap-4">
                                <span
                                    class="flex-shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white text-sm sm:text-base">2</span>
                                <span class="text-base sm:text-lg text-gray-200 pt-1">Dial <span
                                        class="font-bold text-white">+1 438 795 1562</span></span>
                            </li>
                            <li class="flex items-start gap-3 sm:gap-4">
                                <span
                                    class="flex-shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white text-sm sm:text-base">3</span>
                                <span class="text-base sm:text-lg text-gray-200 pt-1">Enter your <span
                                        class="font-bold text-white">4-digit Access Code</span> when prompted</span>
                            </li>
                            <li class="flex items-start gap-3 sm:gap-4">
                                <span
                                    class="flex-shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white text-sm sm:text-base">4</span>
                                <span class="text-base sm:text-lg font-semibold text-santa-gold pt-1">Experience the
                                    magic!</span>
                            </li>
                        </ol>
                    </div>

                    <div id="overage-policy"
                        class="glass-card p-4 sm:p-5 rounded-xl text-sm sm:text-base text-gray-300">
                    </div>
                </div>
            </div>

            <div id="video-success-container" class="hidden animate-fadeInUp stagger-1">
                <div class="glass-card rounded-3xl p-6 sm:p-8 lg:p-10 shadow-2xl space-y-6 sm:space-y-8">

                    <div class="text-center pb-6 border-b border-white/10">
                        <h2
                            class="hero-title text-3xl sm:text-4xl md:text-5xl font-black text-purple-400 mb-3 leading-tight">
                            Your Santa Video<br class="sm:hidden"> is On Its Way!
                        </h2>
                        <p class="text-base sm:text-lg text-gray-300">A magical keepsake is being created</p>
                    </div>

                    <div class="flex justify-center mb-6">
                        <div
                            class="w-32 h-32 sm:w-40 sm:h-40 bg-gradient-to-br from-purple-500/20 to-pink-500/20 rounded-3xl flex items-center justify-center border-2 border-purple-400/30 float-animation">
                            <i data-lucide="sparkles" class="w-16 h-16 sm:w-20 sm:h-20 text-purple-400"></i>
                        </div>
                    </div>

                    <div
                        class="bg-gradient-to-r from-purple-900/30 to-pink-900/30 p-6 sm:p-8 rounded-2xl border border-purple-400/20">
                        <div class="flex items-start gap-4 mb-4">
                            <i data-lucide="mail" class="w-7 h-7 sm:w-8 sm:h-8 text-purple-400 flex-shrink-0 mt-1"></i>
                            <div class="text-left flex-1 min-w-0">
                                <h3 class="text-xl sm:text-2xl font-bold text-purple-300 mb-3">Video Delivery
                                    Information</h3>
                                <p class="text-base sm:text-lg text-gray-200 leading-relaxed mb-4">
                                    Your personalized Santa video will be <span class="font-bold text-white">sent to
                                        your email within 24 hours</span>.
                                    Our elves are working hard to create something truly magical for you!
                                </p>
                                <div class="flex items-start gap-3 bg-slate-900/50 p-4 rounded-xl">
                                    <i data-lucide="inbox" class="w-5 h-5 text-purple-400 flex-shrink-0 mt-0.5"></i>
                                    <span class="text-sm sm:text-base text-gray-300 break-words w-full">Check: <span
                                            id="video-email-display"
                                            class="font-semibold text-white ml-1 break-all"></span></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="glass-card p-6 sm:p-8 rounded-2xl">
                        <h3 class="text-lg sm:text-xl font-bold text-purple-300 flex items-center gap-2 mb-4">
                            <i data-lucide="gift" class="w-6 h-6"></i>
                            What to Expect
                        </h3>
                        <ul class="space-y-3">
                            <li class="flex items-start gap-3 text-base sm:text-lg text-gray-200">
                                <i data-lucide="check-circle" class="w-6 h-6 text-green-400 flex-shrink-0 mt-0.5"></i>
                                <span>Personalized video message from Santa</span>
                            </li>
                            <li class="flex items-start gap-3 text-base sm:text-lg text-gray-200">
                                <i data-lucide="check-circle" class="w-6 h-6 text-green-400 flex-shrink-0 mt-0.5"></i>
                                <span>High-quality video to download and keep forever</span>
                            </li>
                            <li class="flex items-start gap-3 text-base sm:text-lg text-gray-200">
                                <i data-lucide="check-circle" class="w-6 h-6 text-green-400 flex-shrink-0 mt-0.5"></i>
                                <span>Delivery within 24 hours to your inbox</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div id="bundle-success-container" class="hidden animate-fadeInUp stagger-1">
                <div class="glass-card rounded-3xl p-6 sm:p-8 lg:p-10 shadow-2xl space-y-6 sm:space-y-8">

                    <div class="text-center pb-6 border-b border-white/10">
                        <h2
                            class="hero-title text-3xl sm:text-4xl md:text-5xl font-black text-santa-gold mb-3 leading-tight">
                            Santa is Waiting<br class="sm:hidden"> for Your Call!
                        </h2>
                        <p class="text-base sm:text-lg text-gray-300">The complete magical experience awaits</p>
                    </div>

                    <div
                        class="bg-gradient-to-br from-santa-red/20 via-red-900/30 to-santa-red/20 p-6 sm:p-8 lg:p-10 rounded-2xl border-2 border-santa-red shadow-xl shimmer">
                        <p class="text-xs sm:text-sm text-gray-300 uppercase tracking-widest mb-3 text-center">Your
                            Private Access Code</p>
                        <p id="bundle-access-code-display"
                            class="text-6xl sm:text-7xl md:text-8xl lg:text-9xl font-mono font-black text-santa-red text-center tracking-wider mb-6">
                            ----
                        </p>
                        <div class="pt-6 border-t border-white/20 text-center">
                            <p class="text-sm sm:text-base text-gray-300 mb-2">Santa's Hotline</p>
                            <p id="bundle-hotline-number" class="text-2xl sm:text-3xl md:text-4xl font-bold text-white">
                                +1 438 795 1562</p>
                        </div>
                    </div>

                    <div class="glass-card p-6 sm:p-8 rounded-2xl space-y-4 sm:space-y-5">
                        <h3 class="text-xl sm:text-2xl font-bold text-santa-gold flex items-center gap-3">
                            <i data-lucide="phone-call" class="w-6 h-6 sm:w-7 sm:h-7"></i>
                            Call Santa Now - Unlimited Time!
                        </h3>
                        <ol class="space-y-4 sm:space-y-5">
                            <li class="flex items-start gap-3 sm:gap-4">
                                <span
                                    class="flex-shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white text-sm sm:text-base">1</span>
                                <span class="text-base sm:text-lg text-gray-200 pt-1"><span
                                        class="font-semibold text-white">Find a quiet spot</span> with your child and
                                    hand them the phone.</span>
                            </li>
                            <li class="flex items-start gap-3 sm:gap-4">
                                <span
                                    class="flex-shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white text-sm sm:text-base">2</span>
                                <span class="text-base sm:text-lg text-gray-200 pt-1">Dial <span
                                        class="font-bold text-white">+1 438 795 1562</span></span>
                            </li>
                            <li class="flex items-start gap-3 sm:gap-4">
                                <span
                                    class="flex-shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white text-sm sm:text-base">3</span>
                                <span class="text-base sm:text-lg text-gray-200 pt-1">Enter your <span
                                        class="font-bold text-white">4-digit Access Code</span></span>
                            </li>
                            <li class="flex items-start gap-3 sm:gap-4">
                                <span
                                    class="flex-shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white text-sm sm:text-base">4</span>
                                <span class="text-base sm:text-lg font-semibold text-santa-gold pt-1">Enjoy unlimited
                                    talk time!</span>
                            </li>
                        </ol>
                    </div>

                    <div class="grid sm:grid-cols-2 gap-4 sm:gap-6">
                        <div
                            class="bg-gradient-to-br from-blue-900/20 to-indigo-900/20 p-5 sm:p-6 rounded-2xl border border-blue-400/20">
                            <div class="flex items-start gap-3 mb-3">
                                <i data-lucide="message-square-more" class="w-7 h-7 text-blue-400 flex-shrink-0"></i>
                                <h4 class="text-lg sm:text-xl font-bold text-blue-300">Personalized SMS</h4>
                            </div>
                            <p class="text-sm sm:text-base text-gray-300 leading-relaxed">
                                <span class="font-semibold text-white">Text messages from Santa</span> leading up to
                                Christmas
                            </p>
                        </div>

                        <div
                            class="bg-gradient-to-br from-emerald-900/20 to-teal-900/20 p-5 sm:p-6 rounded-2xl border border-emerald-400/20">
                            <div class="flex items-start gap-3 mb-3">
                                <i data-lucide="mic" class="w-7 h-7 text-emerald-400 flex-shrink-0"></i>
                                <h4 class="text-lg sm:text-xl font-bold text-emerald-300">Audio Keepsake</h4>
                            </div>
                            <p class="text-sm sm:text-base text-gray-300 leading-relaxed">
                                <span class="font-semibold text-white">Recording & transcript</span> sent within 24
                                hours
                            </p>
                        </div>
                    </div>

                    <div
                        class="bg-gradient-to-r from-purple-900/30 to-pink-900/30 p-5 sm:p-6 rounded-2xl border border-purple-400/20">
                        <div class="flex items-start gap-3 sm:gap-4">
                            <i data-lucide="mail" class="w-6 h-6 sm:w-7 sm:h-7 text-purple-400 flex-shrink-0 mt-1"></i>
                            <div class="flex-1">
                                <h3 class="text-lg sm:text-xl font-bold text-purple-300 mb-2">Coming to Your Email</h3>
                                <ul class="space-y-2 text-sm sm:text-base text-gray-300 mb-3">
                                    <li class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-4 h-4 text-green-400 flex-shrink-0 mt-1"></i>
                                        <span>Full call recording</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-4 h-4 text-green-400 flex-shrink-0 mt-1"></i>
                                        <span>Complete transcript</span>
                                    </li>
                                </ul>
                                <div class="flex items-center gap-2 bg-slate-900/50 p-3 rounded-lg text-sm">
                                    <i data-lucide="inbox" class="w-4 h-4"></i>
                                    <span id="bundle-email-display" class="font-semibold text-white"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- UPGRADE TEMPLATES START HERE -->
            <!-- Recording Upgrade -->
            <div id="recording-upgrade-container" class="hidden animate-fadeInUp stagger-1">
                <div class="glass-card rounded-3xl p-6 sm:p-8 lg:p-10 shadow-2xl space-y-6 sm:space-y-8">
                    <div class="text-center pb-6 border-b border-white/10">
                        <div
                            class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-green-400 to-emerald-600 rounded-full shadow-2xl shadow-green-500/50 mb-6 float-animation">
                            <i data-lucide="check" class="w-10 h-10 text-white stroke-[3]"></i>
                        </div>
                        <h2 class="hero-title text-3xl sm:text-4xl md:text-5xl font-black text-santa-gold mb-3">Purchase
                            Complete!</h2>
                        <p class="text-lg text-gray-300">Your call recording is ready</p>
                    </div>

                    <div class="glass-card p-6 sm:p-8 rounded-2xl">
                        <div class="flex items-center gap-4 mb-6">
                            <div class="bg-santa-red p-3 rounded-2xl"><i data-lucide="mic"
                                    class="w-7 h-7 text-white"></i></div>
                            <div>
                                <h3 class="text-2xl font-bold text-white">Your Call Recording</h3>
                                <p id="rec-duration" class="text-sm text-gray-400">Duration: 0:00</p>
                            </div>
                        </div>
                        <audio id="rec-audio" controls class="w-full mb-4 rounded-xl"></audio>
                        <a id="rec-download" href="#" download
                            class="inline-flex items-center gap-2 bg-santa-red/20 hover:bg-santa-red/30 text-santa-red py-3 px-6 rounded-xl border border-santa-red/30 w-full justify-center font-semibold transition-all">
                            <i data-lucide="download" class="w-5 h-5"></i><span>Download Recording (MP3)</span>
                        </a>
                    </div>

                    <div class="bg-gradient-to-br from-amber-50 to-amber-100 rounded-3xl p-6 sm:p-8">
                        <div class="flex items-center gap-4 mb-6 pb-4 border-b-2 border-amber-900/20">
                            <div class="bg-amber-800 p-3 rounded-2xl"><i data-lucide="scroll-text"
                                    class="w-7 h-7 text-amber-100"></i></div>
                            <div>
                                <h3 class="text-2xl font-bold text-amber-900">The Conversation</h3>
                                <p class="text-sm text-amber-800 italic">Every magical word preserved</p>
                            </div>
                        </div>
                        <div id="rec-transcript" class="space-y-3 max-h-[400px] overflow-y-auto text-amber-900"></div>
                    </div>

                    <div class="glass-card p-6 sm:p-8 rounded-2xl text-center border-2 border-yellow-400/30">
                        <div
                            class="bg-yellow-500 p-4 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center">
                            <i data-lucide="phone-call" class="w-10 h-10 text-white"></i>
                        </div>
                        <h3 class="text-3xl font-bold text-white mb-3">Want Santa to Call Again?</h3>
                        <p class="text-lg text-gray-300 mb-6">Book a return call where Santa remembers everything!</p>
                        <a id="rec-upsell" href="#"
                            class="inline-flex items-center gap-3 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-black font-bold text-lg py-4 px-8 rounded-full transition-all shadow-xl">
                            <i data-lucide="sparkles" class="w-6 h-6"></i><span>Book Return Call - $10</span>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Return Call Upgrade -->
            <div id="return-call-upgrade-container" class="hidden animate-fadeInUp stagger-1">
                <div class="glass-card rounded-3xl p-6 sm:p-8 lg:p-10 shadow-2xl space-y-6 sm:space-y-8">
                    <div class="text-center pb-6 border-b border-white/10">
                        <div
                            class="bg-yellow-500 p-4 rounded-full w-20 h-20 mx-auto mb-6 flex items-center justify-center float-animation">
                            <i data-lucide="sparkles" class="w-12 h-12 text-white"></i>
                        </div>
                        <h2 class="hero-title text-4xl sm:text-5xl font-black text-santa-gold mb-3">Your Return Call is
                            Ready!</h2>
                        <p class="text-lg text-green-300">Santa can't wait to talk again!</p>
                    </div>

                    <div
                        class="bg-gradient-to-br from-santa-red/20 via-red-900/30 to-santa-red/20 p-8 rounded-2xl border-2 border-santa-red shadow-xl shimmer">
                        <p class="text-sm text-gray-300 uppercase tracking-widest mb-3 text-center">Your New Access Code
                        </p>
                        <p id="ret-code"
                            class="text-7xl sm:text-8xl font-mono font-black text-santa-red text-center mb-6">----</p>
                        <div class="pt-6 border-t border-white/20 text-center">
                            <p class="text-base text-gray-300 mb-2">Call Santa at:</p>
                            <p id="ret-phone" class="text-3xl sm:text-4xl font-bold text-white mb-3">+1 (XXX) XXX-XXXX
                            </p>
                            <div
                                class="inline-flex items-center gap-2 bg-yellow-500/20 border border-yellow-500/50 rounded-lg px-3 py-2">
                                <i data-lucide="alert-triangle" class="w-4 h-4 text-yellow-400"></i>
                                <p class="text-sm text-yellow-300 font-semibold">Make sure to dial Santa's NEW phone
                                    number!</p>
                            </div>
                        </div>
                    </div>

                    <div class="glass-card p-6 rounded-xl bg-green-900/20 border border-green-500/30">
                        <p class="text-base text-green-300 text-center"><strong>‚ú® Special:</strong> Santa will remember
                            your previous conversation!</p>
                    </div>

                    <div class="glass-card p-6 sm:p-8 rounded-2xl">
                        <h3
                            class="text-2xl font-bold text-santa-gold mb-4 text-center flex items-center justify-center gap-3">
                            <i data-lucide="phone-call" class="w-7 h-7"></i>How to Make Your Return Call
                        </h3>
                        <ol class="space-y-4">
                            <li class="flex items-start gap-4">
                                <span
                                    class="w-10 h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white flex-shrink-0">1</span>
                                <span class="text-lg text-gray-200 pt-1">Dial the NEW number above (not your original
                                    number)</span>
                            </li>
                            <li class="flex items-start gap-4">
                                <span
                                    class="w-10 h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white flex-shrink-0">2</span>
                                <span class="text-lg text-gray-200 pt-1">Enter your new 4-digit access code</span>
                            </li>
                            <li class="flex items-start gap-4">
                                <span
                                    class="w-10 h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white flex-shrink-0">3</span>
                                <span class="text-lg text-yellow-400 font-semibold pt-1">Enjoy unlimited talk time with
                                    Santa!</span>
                            </li>
                        </ol>
                    </div>
                </div>
            </div>

            <!-- Bundle Upgrade -->
            <div id="bundle-upgrade-container" class="hidden animate-fadeInUp stagger-1">
                <div class="glass-card rounded-3xl p-6 sm:p-8 lg:p-10 shadow-2xl space-y-6 sm:space-y-8">
                    <div class="text-center pb-6 border-b border-white/10">
                        <div
                            class="bg-yellow-500 p-4 rounded-full w-20 h-20 mx-auto mb-6 flex items-center justify-center float-animation">
                            <i data-lucide="gift" class="w-12 h-12 text-white"></i>
                        </div>
                        <h2 class="hero-title text-4xl sm:text-5xl font-black text-santa-gold mb-3">Ultimate Bundle
                            Activated!</h2>
                        <p class="text-lg text-green-300">Everything you need for the perfect Santa experience</p>
                    </div>

                    <div
                        class="bg-gradient-to-br from-santa-red/20 via-red-900/30 to-santa-red/20 p-8 rounded-2xl border-2 border-santa-red shadow-xl shimmer">
                        <p class="text-sm text-gray-300 uppercase tracking-widest mb-3 text-center">Your New Access Code
                        </p>
                        <p id="bundle-upgrade-code"
                            class="text-7xl sm:text-8xl font-mono font-black text-santa-red text-center mb-6">----</p>
                        <div class="pt-6 border-t border-white/20 text-center">
                            <p class="text-base text-gray-300 mb-2">Call Santa at:</p>
                            <p id="bundle-upgrade-phone" class="text-3xl sm:text-4xl font-bold text-white mb-3">+1 (XXX)
                                XXX-XXXX</p>
                            <div
                                class="inline-flex items-center gap-2 bg-yellow-500/20 border border-yellow-500/50 rounded-lg px-3 py-2">
                                <i data-lucide="alert-triangle" class="w-4 h-4 text-yellow-400"></i>
                                <p class="text-sm text-yellow-300 font-semibold">Make sure to dial Santa's NEW phone
                                    number!</p>
                            </div>
                        </div>
                    </div>

                    <div class="grid sm:grid-cols-2 gap-4">
                        <div class="glass-card p-5 rounded-xl bg-blue-900/20 border border-blue-500/30">
                            <p class="text-base text-blue-300 text-center"><strong>‚è±Ô∏è 5-Minute Call:</strong> Your next
                                call will be up to 5 minutes</p>
                        </div>
                        <div class="glass-card p-5 rounded-xl bg-green-900/20 border border-green-500/30">
                            <p class="text-base text-green-300 text-center"><strong>‚ú® Santa Remembers:</strong> He'll
                                reference your previous call!</p>
                        </div>
                    </div>

                    <h3 class="text-3xl font-bold text-white text-center">Your Previous Call with Santa</h3>

                    <div class="max-w-2xl mx-auto glass-card p-6 sm:p-8 rounded-2xl">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="bg-santa-red p-3 rounded-2xl"><i data-lucide="mic"
                                    class="w-6 h-6 text-white"></i></div>
                            <div>
                                <h4 class="text-xl font-bold text-white">Recording</h4>
                                <p id="bundle-upgrade-duration" class="text-sm text-gray-400">Duration: 0:00</p>
                            </div>
                        </div>
                        <audio id="bundle-upgrade-audio" controls class="w-full mb-4 rounded-xl"></audio>
                        <a id="bundle-upgrade-download" href="#" download
                            class="inline-flex items-center gap-2 bg-santa-red/20 hover:bg-santa-red/30 text-santa-red py-2 px-4 rounded-xl border border-santa-red/30 w-full justify-center text-sm font-semibold transition-all">
                            <i data-lucide="download" class="w-4 h-4"></i><span>Download</span>
                        </a>
                    </div>

                    <div class="bg-gradient-to-br from-amber-50 to-amber-100 rounded-3xl p-6 sm:p-8">
                        <div class="flex items-center gap-4 mb-6 pb-4 border-b-2 border-amber-900/20">
                            <div class="bg-amber-800 p-3 rounded-2xl"><i data-lucide="scroll-text"
                                    class="w-7 h-7 text-amber-100"></i></div>
                            <div>
                                <h3 class="text-2xl font-bold text-amber-900">The Conversation</h3>
                                <p class="text-sm text-amber-800 italic">Every magical word preserved</p>
                            </div>
                        </div>
                        <div id="bundle-upgrade-transcript"
                            class="space-y-3 max-h-[400px] overflow-y-auto text-amber-900"></div>
                    </div>

                    <div class="glass-card p-6 sm:p-8 rounded-2xl">
                        <h3 class="text-2xl font-bold text-santa-gold mb-4 text-center">How to Make Your Next Call</h3>
                        <ol class="space-y-4">
                            <li class="flex items-start gap-4">
                                <span
                                    class="w-10 h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white flex-shrink-0">1</span>
                                <span class="text-lg text-gray-200 pt-1">Dial the NEW number above</span>
                            </li>
                            <li class="flex items-start gap-4">
                                <span
                                    class="w-10 h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white flex-shrink-0">2</span>
                                <span class="text-lg text-gray-200 pt-1">Enter your new 4-digit access code</span>
                            </li>
                            <li class="flex items-start gap-4">
                                <span
                                    class="w-10 h-10 bg-santa-red rounded-full flex items-center justify-center font-bold text-white flex-shrink-0">3</span>
                                <span class="text-lg text-yellow-400 font-semibold pt-1">Enjoy up to 5 minutes with
                                    Santa!</span>
                            </li>
                        </ol>
                    </div>
                </div>
            </div>

            <div class="space-y-4 animate-fadeInUp stagger-2">
                <div class="glass-card p-5 sm:p-6 rounded-2xl text-center">
                    <p class="text-base sm:text-lg text-gray-300 flex items-center justify-center gap-2 flex-wrap">
                        <i data-lucide="help-circle" class="w-5 h-5 sm:w-6 sm:h-6 text-santa-gold"></i>
                        <span>Questions? Email us at</span>
                        <a href="mailto:info@callsanta.us"
                            class="font-bold text-santa-gold hover:text-white transition-colors">
                            info@callsanta.us
                        </a>
                    </p>
                </div>

                <div class="text-center">
                    <a href="/"
                        class="inline-flex items-center gap-3 px-8 py-4 bg-gradient-to-r from-santa-red to-red-700 hover:from-red-700 hover:to-santa-red rounded-2xl font-bold text-base sm:text-lg transition-all duration-300 shadow-2xl hover:shadow-santa-red/50 hover:scale-105">
                        <i data-lucide="home" class="w-5 h-5 sm:w-6 sm:h-6"></i>
                        Return to Home
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        const GET_ORDER_DETAILS_URL = '/.netlify/functions/get-order-details';
        const GET_UPGRADE_SUCCESS_URL = '/.netlify/functions/get-upgrade-success';
        const TWILIO_PHONE_NUMBER = "+1 438 795 1562";

        async function fetchOrderDetails() {
            const urlParams = new URLSearchParams(window.location.search);
            const paymentIntentId = urlParams.get('payment_intent');
            const orderId = urlParams.get('order_id'); // NEW: Get order_id

            // MODIFIED: Check for either ID
            if (!paymentIntentId && !orderId) {
                console.error('No payment intent ID or Order ID found');
                showFallbackMessage();
                return;
            }

            try {
                // Only check upgrades if we have a payment_intent (upgrades are usually Stripe-based)
                if (paymentIntentId) {
                    const upgradeResponse = await fetch(`${GET_UPGRADE_SUCCESS_URL}?payment_intent_id=${paymentIntentId}`);

                    if (upgradeResponse.ok) {
                        const upgradeData = await upgradeResponse.json();

                        if (upgradeData.isUpgrade) {
                            displayUpgradeSuccess(upgradeData);
                            return;
                        }
                    }
                }

                // MODIFIED: Construct URL based on available ID
                let fetchUrl = `${GET_ORDER_DETAILS_URL}?`;
                if (orderId) {
                    fetchUrl += `order_id=${orderId}`;
                } else {
                    fetchUrl += `payment_intent_id=${paymentIntentId}`;
                }

                const response = await fetch(fetchUrl);

                if (!response.ok) {
                    console.log('Backend function not available, using localStorage fallback');
                    const orderData = localStorage.getItem('lastOrderData');
                    if (orderData) {
                        const data = JSON.parse(orderData);
                        displayOrderDetails(data);
                    } else {
                        showFallbackMessage();
                    }
                    return;
                }

                const data = await response.json();

                if (data.error || !data.packageId) {
                    console.error("Order lookup failed:", data.error);
                    showFallbackMessage();
                    return;
                }

                displayOrderDetails(data);

            } catch (e) {
                console.error("Network or parsing error:", e);
                const orderData = localStorage.getItem('lastOrderData');
                if (orderData) {
                    const data = JSON.parse(orderData);
                    displayOrderDetails(data);
                } else {
                    showFallbackMessage();
                }
            }
        }

        function displayUpgradeSuccess(data) {
            const { upgradeType, originalCall, newAccessCode, twilioNumber } = data;

            if (upgradeType === 'recording') {
                document.getElementById('recording-upgrade-container').classList.remove('hidden');
                if (originalCall?.audioUrl) {
                    document.getElementById('rec-audio').src = originalCall.audioUrl;
                    document.getElementById('rec-download').href = originalCall.audioUrl;
                    if (originalCall.callDuration) {
                        const min = Math.floor(originalCall.callDuration / 60);
                        const sec = originalCall.callDuration % 60;
                        document.getElementById('rec-duration').textContent = `Duration: ${min}:${sec.toString().padStart(2, '0')}`;
                    }
                }
                if (originalCall?.transcript) { showTranscript('rec-transcript', originalCall.transcript); }
                if (originalCall?.accessCode) { document.getElementById('rec-upsell').href = `/upgrade/return-call?order=${originalCall.accessCode}`; }
            } else if (upgradeType === 'return_call') {
                document.getElementById('return-call-upgrade-container').classList.remove('hidden');
                document.getElementById('ret-code').textContent = newAccessCode || '----';
                document.getElementById('ret-phone').textContent = twilioNumber || '+1 (XXX) XXX-XXXX';
            } else if (upgradeType === 'bundle') {
                document.getElementById('bundle-upgrade-container').classList.remove('hidden');
                document.getElementById('bundle-upgrade-code').textContent = newAccessCode || '----';
                document.getElementById('bundle-upgrade-phone').textContent = twilioNumber || '+1 (XXX) XXX-XXXX';
                if (originalCall?.audioUrl) {
                    document.getElementById('bundle-upgrade-audio').src = originalCall.audioUrl;
                    document.getElementById('bundle-upgrade-download').href = originalCall.audioUrl;
                    if (originalCall.callDuration) {
                        const min = Math.floor(originalCall.callDuration / 60);
                        const sec = originalCall.callDuration % 60;
                        document.getElementById('bundle-upgrade-duration').textContent = `Duration: ${min}:${sec.toString().padStart(2, '0')}`;
                    }
                }
                if (originalCall?.transcript) { showTranscript('bundle-upgrade-transcript', originalCall.transcript); }
            }
            lucide.createIcons();
        }

        function showTranscript(elementId, transcript) {
            const div = document.getElementById(elementId);
            const lines = transcript.split('\n');
            div.innerHTML = lines.map(line => {
                if (!line.trim()) return '';
                const santa = line.match(/^(Santa|AI|Assistant):\s*(.+)/i);
                const child = line.match(/^(Child|User|Kid|[A-Z][a-z]+):\s*(.+)/i);
                if (santa) { return `<div class="message-santa"><strong>üéÖ Santa:</strong> ${santa[2]}</div>`; }
                else if (child) { return `<div class="message-child"><strong>${child[1]}:</strong> ${child[2]}</div>`; }
                else { return `<div class="message-child">${line}</div>`; }
            }).join('');
        }

        function displayOrderDetails(data) {
            const greetingMessage = document.getElementById('greeting-message');
            const callContainer = document.getElementById('call-success-container');
            const videoContainer = document.getElementById('video-success-container');
            const bundleContainer = document.getElementById('bundle-success-container');

            if (greetingMessage && data.childName) {
                greetingMessage.innerHTML = `Thank you, ${data.childName}'s parent!`;
            }

            callContainer.classList.add('hidden');
            videoContainer.classList.add('hidden');
            bundleContainer.classList.add('hidden');

            if (data.packageId === 'call') {
                displayCallSuccess(data);
            } else if (data.packageId === 'video') {
                displayVideoSuccess(data);
            } else if (data.packageId === 'bundle') {
                displayBundleSuccess(data);
            }

            // Track Purchase Event
            if (typeof fbq === 'function') {
                const valueInDollars = (data.amountPaid || 0) / 100;
                fbq('track', 'Purchase', {
                    value: valueInDollars,
                    currency: data.currency || 'USD',
                    content_name: data.packageId,
                    content_ids: [data.packageId],
                    content_type: 'product'
                });
            }
        }

        function displayCallSuccess(data) {
            const container = document.getElementById('call-success-container');
            const accessCodeDisplay = document.getElementById('access-code-display');
            const overagePolicy = document.getElementById('overage-policy');

            container.classList.remove('hidden');

            if (accessCodeDisplay && data.accessCode) {
                accessCodeDisplay.innerText = data.accessCode;
            }

            if (overagePolicy) {
                if (data.overageOption === 'unlimited') {
                    overagePolicy.innerHTML = `
                        <div class="flex items-start gap-3">
                            <i data-lucide="infinity" class="w-6 h-6 text-green-400 flex-shrink-0 mt-0.5"></i>
                            <div>
                                <strong class="text-white">Unlimited Talk Time:</strong> You selected unlimited call time. Talk as long as you'd like!
                            </div>
                        </div>
                    `;
                } else {
                    overagePolicy.innerHTML = `
                        <div class="flex items-start gap-3">
                            <i data-lucide="info" class="w-6 h-6 text-blue-400 flex-shrink-0 mt-0.5"></i>
                            <div>
                                <strong class="text-white">Policy:</strong> Your call will automatically disconnect after 5 minutes to prevent extra charges.
                            </div>
                        </div>
                    `;
                }
                lucide.createIcons();
            }
        }

        function displayVideoSuccess(data) {
            const container = document.getElementById('video-success-container');
            const emailDisplay = document.getElementById('video-email-display');

            container.classList.remove('hidden');

            if (emailDisplay && data.parentEmail) {
                emailDisplay.innerText = data.parentEmail;
            }
        }

        function displayBundleSuccess(data) {
            const container = document.getElementById('bundle-success-container');
            const accessCodeDisplay = document.getElementById('bundle-access-code-display');
            const emailDisplay = document.getElementById('bundle-email-display');

            container.classList.remove('hidden');

            if (accessCodeDisplay && data.accessCode) {
                accessCodeDisplay.innerText = data.accessCode;
            }

            if (emailDisplay && data.parentEmail) {
                emailDisplay.innerText = data.parentEmail;
            }
        }

        function showFallbackMessage() {
            const greetingMessage = document.getElementById('greeting-message');
            if (greetingMessage) {
                greetingMessage.innerHTML = 'Your order was successful! Check your email for details.';
            }
        }

        document.addEventListener('DOMContentLoaded', fetchOrderDetails);
    </script>
</body>

</html>